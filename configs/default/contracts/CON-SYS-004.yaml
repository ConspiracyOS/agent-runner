id: CON-SYS-004
description: Concierge sessions must not exceed 30 minutes
type: detective
frequency: 60s
scope: agent:concierge
checks:
  - name: session_duration
    command:
      run: "ps -eo user,etimes,args --no-headers | grep '^a-concierge ' | grep '[c]on run' | awk '{if ($2 > 1800) print $1}' | head -1"
      test: "[ -z \"$RESULT\" ]"
    on_fail:
      action: kill_session
      escalate: sysadmin
      message: "CON-SYS-004 FAILED: concierge session exceeds 30 minutes"
