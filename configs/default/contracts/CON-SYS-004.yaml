id: CON-SYS-004
description: Agent sessions must not exceed 30 minutes
type: detective
frequency: 60s
scope: system
checks:
  - name: session_duration
    command:
      run: "ps -eo user,etimes,args --no-headers | grep '^a-' | grep '[c]on run' | awk '{if ($2 > 1800) print $1}' | head -1"
      test: "[ -z \"$RESULT\" ]"
    on_fail:
      action: alert
      message: "CON-SYS-004 FAILED: agent session exceeds 30 minutes"
