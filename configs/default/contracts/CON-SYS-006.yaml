id: CON-SYS-006
description: /etc/con/env must be mode 600 root:root (only systemd reads it)
type: detective
frequency: 60s
scope: system
checks:
  - name: env_file_root_only
    command:
      run: "stat -c '%U %G %a' /etc/con/env"
      test: "echo \"$RESULT\" | awk '{print ($1==\"root\" && $2==\"root\" && $3==\"600\") ? 0 : 1}' | grep -q 0"
    on_fail:
      action: alert
      message: "CON-SYS-006 FAILED: /etc/con/env is not mode 600 root:root â€” agents can read secrets directly"
